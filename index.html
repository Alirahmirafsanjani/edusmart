<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduSmart - Platform Edukasi Terpadu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Plus Jakarta Sans', 'sans-serif'],
                        display: ['Fredoka', 'sans-serif'],
                    },
                    colors: {
                        primary: '#2563EB', // Blue 600
                        secondary: '#F59E0B', // Amber 500
                        sd: '#EF4444', // Red for SD
                        smp: '#2563EB', // Blue for SMP
                        sma: '#6B7280', // Gray for SMA
                        correct: '#10B981', // Green for correct answer
                        wrong: '#EF4444', // Red for wrong answer
                    },
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                    }
                }
            }
        }
    </script>
    <style>
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .chat-bubble { position: relative; max-width: 80%; }
        .chat-bubble::after { content: ''; position: absolute; bottom: 0; width: 0; height: 0; border: 10px solid transparent; }
        .chat-left::after { left: -10px; border-right-color: #F3F4F6; border-bottom: 0; }
        .chat-right::after { right: -10px; border-left-color: #DBEAFE; border-bottom: 0; }
        
        /* Animasi Transisi */
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Quiz Styles */
        .option-btn.correct { background-color: #D1FAE5; border-color: #10B981; color: #065F46; }
        .option-btn.wrong { background-color: #FEE2E2; border-color: #EF4444; color: #991B1B; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

    <!-- Navbar -->
    <nav class="bg-white sticky top-0 z-50 border-b border-gray-200 shadow-sm">
        <div class="container mx-auto px-4 h-16 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center text-white">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <span class="font-display font-bold text-xl text-primary">EduSmart</span>
            </div>
            <div class="flex gap-4 items-center">
                <span class="hidden md:inline text-sm text-gray-500">Halo, Siswa</span>
                <div class="w-8 h-8 rounded-full bg-gray-200 overflow-hidden border border-gray-300">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="User">
                </div>
            </div>
        </div>
    </nav>

    <!-- Level Selector (Pemisah Jenjang) -->
    <section class="bg-white py-6 border-b border-gray-200">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-lg font-bold mb-4 text-gray-700">Pilih Jenjang Pendidikan Kamu</h2>
            <div class="flex justify-center gap-2 md:gap-4">
                <button onclick="switchLevel('SD')" id="btn-sd" class="level-btn px-6 py-2 rounded-full border-2 border-red-100 bg-red-50 text-red-600 font-bold hover:bg-red-100 transition flex items-center gap-2">
                    <i class="fas fa-shapes"></i> SD
                </button>
                <button onclick="switchLevel('SMP')" id="btn-smp" class="level-btn px-6 py-2 rounded-full border-2 border-blue-500 bg-blue-600 text-white font-bold shadow-lg shadow-blue-200 transition flex items-center gap-2">
                    <i class="fas fa-book-reader"></i> SMP
                </button>
                <button onclick="switchLevel('SMA')" id="btn-sma" class="level-btn px-6 py-2 rounded-full border-2 border-gray-100 bg-gray-50 text-gray-600 font-bold hover:bg-gray-200 transition flex items-center gap-2">
                    <i class="fas fa-atom"></i> SMA
                </button>
            </div>
        </div>
    </section>

    <!-- Main Content Area -->
    <main class="container mx-auto px-4 py-8">
        
        <!-- Header per Jenjang -->
        <div id="level-header" class="mb-8 fade-in">
            <!-- Content injected by JS -->
        </div>

        <!-- Navigation Tabs (Materi vs Diskusi vs Kuis) -->
        <div class="flex border-b border-gray-200 mb-6 gap-6 overflow-x-auto hide-scrollbar">
            <button onclick="switchTab('materi')" class="tab-btn active border-b-2 border-primary text-primary font-bold pb-3 px-2 whitespace-nowrap">
                <i class="fas fa-book mr-2"></i>Materi Pelajaran
            </button>
            <button onclick="switchTab('diskusi')" class="tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium pb-3 px-2 whitespace-nowrap relative">
                <i class="fas fa-comments mr-2"></i>Forum Diskusi
                <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
            </button>
            <button onclick="switchTab('kuis')" class="tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium pb-3 px-2 whitespace-nowrap">
                <i class="fas fa-gamepad mr-2"></i>Kuis & Latihan
            </button>
        </div>

        <!-- SECTION 1: MATERI -->
        <div id="tab-materi" class="tab-content fade-in">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Card Materi -->
                <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition cursor-pointer">
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-lg bg-orange-100 flex items-center justify-center text-orange-600 text-xl">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <span class="text-xs font-bold text-gray-400 bg-gray-100 px-2 py-1 rounded">Bab 1</span>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Aljabar Linear</h3>
                    <p class="text-gray-500 text-sm mb-4 line-clamp-2">Memahami konsep variabel, koefisien, dan konstanta dalam matematika.</p>
                    <div class="flex items-center text-sm text-primary font-bold">
                        Akses Materi <i class="fas fa-arrow-right ml-2"></i>
                    </div>
                </div>

                <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition cursor-pointer">
                    <div class="flex justify-between items-start mb-4">
                        <div class="w-12 h-12 rounded-lg bg-green-100 flex items-center justify-center text-green-600 text-xl">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <span class="text-xs font-bold text-gray-400 bg-gray-100 px-2 py-1 rounded">Bab 3</span>
                    </div>
                    <h3 class="font-bold text-lg mb-2">Sistem Ekskresi</h3>
                    <p class="text-gray-500 text-sm mb-4 line-clamp-2">Belajar tentang organ-organ pembuangan pada tubuh manusia dan fungsinya.</p>
                    <div class="flex items-center text-sm text-primary font-bold">
                        Akses Materi <i class="fas fa-arrow-right ml-2"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 2: FORUM DISKUSI (FITUR UTAMA) -->
        <div id="tab-diskusi" class="tab-content hidden fade-in">
            <div class="flex flex-col lg:flex-row gap-6">
                
                <!-- Sidebar Topik -->
                <div class="w-full lg:w-1/4">
                    <div class="bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
                        <h3 class="font-bold text-gray-700 mb-4">Topik Diskusi</h3>
                        <div class="space-y-2">
                            <button class="w-full text-left px-3 py-2 rounded-lg bg-blue-50 text-blue-700 font-medium text-sm">Semua Mapel</button>
                            <button class="w-full text-left px-3 py-2 rounded-lg hover:bg-gray-50 text-gray-600 font-medium text-sm">Matematika</button>
                            <button class="w-full text-left px-3 py-2 rounded-lg hover:bg-gray-50 text-gray-600 font-medium text-sm">IPA / Fisika</button>
                            <button class="w-full text-left px-3 py-2 rounded-lg hover:bg-gray-50 text-gray-600 font-medium text-sm">Bahasa Inggris</button>
                        </div>
                        <button onclick="document.getElementById('question-modal').classList.remove('hidden')" class="w-full mt-4 bg-primary text-white py-2 rounded-lg font-bold text-sm shadow-lg shadow-blue-200 hover:bg-blue-700 transition">
                            <i class="fas fa-plus mr-2"></i> Buat Pertanyaan
                        </button>
                    </div>
                </div>

                <!-- Main Discussion Feed -->
                <div class="w-full lg:w-3/4 space-y-6">
                    <!-- Info Alert -->
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas fa-info-circle text-yellow-600"></i>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-yellow-700">
                                    <span class="font-bold">Info Guru:</span> Pak Budi (Fisika) sedang online. Silakan ajukan pertanyaan jika ada materi yang belum jelas.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Thread 1 (Ada Jawaban Guru) -->
                    <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-gray-200 overflow-hidden">
                                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Andi" alt="Siswa">
                                </div>
                                <div>
                                    <h4 class="font-bold text-sm">Andi Saputra <span class="text-xs font-normal text-gray-400">â€¢ 20 menit lalu</span></h4>
                                    <span class="text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full font-bold">Fisika - Bab 2</span>
                                </div>
                            </div>
                            <span class="bg-green-100 text-green-700 text-xs px-2 py-1 rounded font-bold"><i class="fas fa-check-circle mr-1"></i>Dijawab Guru</span>
                        </div>
                        
                        <h3 class="font-bold text-lg mb-2">Bingung tentang Hukum Newton II</h3>
                        <p class="text-gray-600 text-sm mb-4">
                            Pak/Bu, saya masih bingung kenapa percepatan berbanding terbalik dengan massa? Bisa tolong jelaskan dengan contoh sehari-hari? Terima kasih.
                        </p>

                        <!-- Jawaban Guru -->
                        <div class="bg-blue-50 rounded-lg p-4 mt-4 border border-blue-100 ml-4 relative">
                            <div class="flex items-center gap-2 mb-2">
                                <div class="w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center text-white text-xs">
                                    <i class="fas fa-chalkboard-teacher"></i>
                                </div>
                                <span class="font-bold text-sm text-blue-800">Pak Budi (Guru Fisika)</span>
                            </div>
                            <p class="text-sm text-gray-700">
                                Halo Andi. Coba bayangkan kamu mendorong sepeda motor vs mendorong truk mogok dengan tenaga yang sama. Pasti motor lebih cepat bergeraknya kan? Itu karena massa truk besar, jadi percepatannya kecil (lambat). Semakin besar massa benda, semakin "malas" dia bergerak.
                            </p>
                        </div>

                        <div class="flex items-center gap-4 mt-4 pt-4 border-t border-gray-100 text-gray-400 text-sm">
                            <button class="hover:text-primary flex items-center gap-1"><i class="far fa-heart"></i> 5 Suka</button>
                            <button class="hover:text-primary flex items-center gap-1"><i class="far fa-comment-dots"></i> Balas</button>
                        </div>
                    </div>

                    <!-- Thread 2 (Belum Dijawab) -->
                    <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-6">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-full bg-gray-200 overflow-hidden">
                                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Siti" alt="Siswa">
                                </div>
                                <div>
                                    <h4 class="font-bold text-sm">Siti Aminah <span class="text-xs font-normal text-gray-400">â€¢ 5 menit lalu</span></h4>
                                    <span class="text-xs bg-orange-100 text-orange-700 px-2 py-0.5 rounded-full font-bold">Matematika</span>
                                </div>
                            </div>
                            <span class="bg-gray-100 text-gray-500 text-xs px-2 py-1 rounded font-bold"><i class="fas fa-clock mr-1"></i>Menunggu</span>
                        </div>
                        
                        <h3 class="font-bold text-lg mb-2">Cara cepat menghitung akar pangkat 3?</h3>
                        <p class="text-gray-600 text-sm mb-4">
                            Teman-teman atau Bapak/Ibu guru, ada trik cepat gak ya buat ngerjain soal akar pangkat 3 ribuan? Besok mau ulangan harian nih.
                        </p>

                        <div class="flex items-center gap-4 mt-4 pt-4 border-t border-gray-100 text-gray-400 text-sm">
                            <button class="hover:text-primary flex items-center gap-1"><i class="far fa-heart"></i> 12 Suka</button>
                            <button class="hover:text-primary flex items-center gap-1"><i class="far fa-comment-dots"></i> 2 Balasan</button>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- SECTION 3: KUIS (DIPERBARUI) -->
        <div id="tab-kuis" class="tab-content hidden fade-in">
            <!-- 3.1: Menu Kuis (Pilih Mata Pelajaran) -->
            <div id="quiz-menu" class="bg-white rounded-2xl p-8 border border-gray-200 text-center shadow-sm">
                <div class="w-20 h-20 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl">
                    <i class="fas fa-trophy"></i>
                </div>
                <h3 id="quiz-title-display" class="text-2xl font-bold mb-2">Kuis Harian SMP</h3>
                <p class="text-gray-500 mb-6">Pilih mata pelajaran untuk mulai mengerjakan.</p>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 max-w-2xl mx-auto">
                    <button onclick="startQuiz('Matematika')" class="p-4 border border-gray-200 rounded-xl hover:border-primary hover:bg-blue-50 transition text-left group">
                        <span class="block font-bold text-gray-800 group-hover:text-primary">Matematika</span>
                        <span class="text-xs text-gray-400">Tersedia 3 Soal</span>
                    </button>
                    <button onclick="startQuiz('IPA')" class="p-4 border border-gray-200 rounded-xl hover:border-primary hover:bg-blue-50 transition text-left group">
                        <span class="block font-bold text-gray-800 group-hover:text-primary">IPA (Sains)</span>
                        <span class="text-xs text-gray-400">Tersedia 3 Soal</span>
                    </button>
                    <button onclick="startQuiz('Umum')" class="p-4 border border-gray-200 rounded-xl hover:border-primary hover:bg-blue-50 transition text-left group">
                        <span class="block font-bold text-gray-800 group-hover:text-primary">Pengetahuan Umum</span>
                        <span class="text-xs text-gray-400">Tersedia 3 Soal</span>
                    </button>
                </div>
            </div>

            <!-- 3.2: Interface Kuis (Soal Aktif) -->
            <div id="quiz-interface" class="hidden max-w-2xl mx-auto">
                <div class="bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden">
                    <!-- Header Kuis -->
                    <div class="bg-gray-50 px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                        <div>
                            <span id="active-subject" class="text-xs font-bold uppercase tracking-wider text-primary">MATEMATIKA</span>
                            <h4 class="font-bold text-gray-800">Pertanyaan <span id="q-current">1</span> dari <span id="q-total">10</span></h4>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-gray-500 block">Skor Sementara</span>
                            <span id="current-score" class="font-bold text-primary text-lg">0</span>
                        </div>
                    </div>

                    <!-- Body Soal -->
                    <div class="p-6 md:p-8">
                        <p id="question-text" class="text-lg md:text-xl font-medium text-gray-800 mb-8 leading-relaxed">
                            Loading question...
                        </p>
                        
                        <div id="options-container" class="space-y-3">
                            <!-- Options injected by JS -->
                        </div>
                    </div>

                    <!-- Footer Kuis -->
                    <div class="bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-between items-center">
                        <button onclick="resetQuiz()" class="text-gray-500 hover:text-red-500 text-sm font-medium px-4 py-2">
                            Keluar
                        </button>
                        <button id="btn-next" onclick="nextQuestion()" class="bg-primary text-white px-6 py-2 rounded-lg font-bold shadow-md hover:bg-blue-700 transition disabled:opacity-50 hidden">
                            Lanjut <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 3.3: Hasil Kuis -->
            <div id="quiz-result" class="hidden bg-white rounded-2xl p-8 border border-gray-200 text-center shadow-sm max-w-lg mx-auto">
                <i class="fas fa-star text-6xl text-yellow-400 mb-4 animate-bounce"></i>
                <h3 class="text-2xl font-bold mb-2">Kuis Selesai!</h3>
                <p class="text-gray-500 mb-6">Kamu telah menyelesaikan kuis <span id="result-subject" class="font-bold text-gray-800">Matematika</span>.</p>
                
                <div class="bg-gray-50 rounded-xl p-6 mb-6">
                    <span class="block text-sm text-gray-500 uppercase tracking-wide">Skor Akhir</span>
                    <span id="final-score-display" class="block text-5xl font-bold text-primary my-2">80</span>
                    <span id="final-feedback" class="text-sm font-medium text-green-600">Luar Biasa! ðŸŽ‰</span>
                </div>

                <button onclick="resetQuiz()" class="bg-primary text-white w-full py-3 rounded-xl font-bold hover:bg-blue-700 transition">
                    Kembali ke Menu Kuis
                </button>
            </div>
        </div>
    </main>

    <!-- Modal Buat Pertanyaan (Hidden by default) -->
    <div id="question-modal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl w-full max-w-lg p-6 shadow-2xl animate-bounce-slow">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-xl">Ajukan Pertanyaan</h3>
                <button onclick="document.getElementById('question-modal').classList.add('hidden')" class="text-gray-400 hover:text-red-500">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form onsubmit="event.preventDefault(); alert('Pertanyaan berhasil dikirim! Guru akan segera menjawab.'); document.getElementById('question-modal').classList.add('hidden');">
                <div class="mb-4">
                    <label class="block text-sm font-bold text-gray-700 mb-1">Mata Pelajaran</label>
                    <select class="w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-primary focus:outline-none">
                        <option>Matematika</option>
                        <option>IPA</option>
                        <option>Bahasa Inggris</option>
                        <option>Lainnya</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-bold text-gray-700 mb-1">Judul Pertanyaan</label>
                    <input type="text" class="w-full border border-gray-300 rounded-lg p-2.5 focus:ring-2 focus:ring-primary focus:outline-none" placeholder="Contoh: Rumus Phytagoras">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-bold text-gray-700 mb-1">Isi Pertanyaan</label>
                    <textarea class="w-full border border-gray-300 rounded-lg p-2.5 h-32 focus:ring-2 focus:ring-primary focus:outline-none" placeholder="Jelaskan detail pertanyaanmu disini..."></textarea>
                </div>
                <button type="submit" class="w-full bg-primary text-white font-bold py-3 rounded-xl hover:bg-blue-700 transition">Kirim Pertanyaan</button>
            </form>
        </div>
    </div>

    <script>
        // --- 1. CONFIGURATION & DATA ---
        
        // Data Tampilan per Jenjang
        const contentData = {
            'SD': {
                color: 'red',
                title: 'Dunia Belajar Ceria SD',
                desc: 'Belajar sambil bermain dengan video animasi lucu dan kuis warna-warni.',
                quizTitle: 'Kuis Petualangan SD'
            },
            'SMP': {
                color: 'blue',
                title: 'Ruang Belajar Interaktif SMP',
                desc: 'Akses materi, kerjakan kuis, dan tanyakan hal yang sulit dimengerti kepada guru melalui forum diskusi.',
                quizTitle: 'Kuis Harian SMP'
            },
            'SMA': {
                color: 'gray',
                title: 'Persiapan Ujian & Materi SMA',
                desc: 'Diskusi mendalam untuk persiapan UTBK, materi kompleks, dan bimbingan karir.',
                quizTitle: 'Tryout & Latihan Soal SMA'
            }
        };

        // DATABASE SOAL KUIS (EDIT BAGIAN INI UNTUK MEMASUKKAN PERTANYAAN BARU)
        const quizDatabase = {
            'SD': {
                'Matematika': [
                    { q: "5 + 5 = ...", options: ["10", "15", "8", "9"], correct: 0 },
                    { q: "Bangun datar yang memiliki 3 sisi disebut...", options: ["Persegi", "Segitiga", "Lingkaran", "Kotak"], correct: 1 },
                    { q: "10 - 4 = ...", options: ["5", "6", "7", "4"], correct: 1 }
                ],
                'IPA': [
                    { q: "Hewan pemakan daging disebut...", options: ["Herbivora", "Karnivora", "Omnivora", "Insektivora"], correct: 1 },
                    { q: "Matahari terbit dari sebelah...", options: ["Barat", "Selatan", "Timur", "Utara"], correct: 2 },
                    { q: "Kucing berkembang biak dengan cara...", options: ["Bertelur", "Melahirkan", "Membelah diri", "Bertunas"], correct: 1 }
                ],
                'Umum': [
                    { q: "Ibukota Indonesia adalah...", options: ["Bandung", "Jakarta", "Surabaya", "Medan"], correct: 1 },
                    { q: "Warna bendera Indonesia adalah...", options: ["Merah Putih", "Putih Merah", "Merah Biru", "Kuning Hijau"], correct: 0 },
                    { q: "Presiden pertama Indonesia adalah...", options: ["Soeharto", "Soekarno", "Habibie", "Jokowi"], correct: 1 }
                ]
            },
            'SMP': {
                'Matematika': [
                    { q: "Hasil dari -5 + 12 adalah...", options: ["-7", "7", "17", "-17"], correct: 1 },
                    { q: "Rumus luas lingkaran adalah...", options: ["2 x Ï€ x r", "Ï€ x r x r", "p x l", "s x s"], correct: 1 },
                    { q: "Sudut siku-siku besarnya... derajat", options: ["45", "90", "180", "360"], correct: 1 }
                ],
                'IPA': [
                    { q: "Bagian terkecil dari makhluk hidup disebut...", options: ["Jaringan", "Organ", "Sel", "Sistem Organ"], correct: 2 },
                    { q: "Satuan kuat arus listrik adalah...", options: ["Volt", "Ampere", "Watt", "Ohm"], correct: 1 },
                    { q: "Peristiwa perubahan wujud dari cair ke gas disebut...", options: ["Mencair", "Membeku", "Menguap", "Menyublim"], correct: 2 }
                ],
                'Umum': [
                    { q: "Negara yang dijuluki Negeri Sakura adalah...", options: ["Korea", "Cina", "Jepang", "Thailand"], correct: 2 },
                    { q: "Candi Borobudur terletak di provinsi...", options: ["Jawa Timur", "Jawa Tengah", "Yogyakarta", "Jawa Barat"], correct: 1 },
                    { q: "Tanggal 17 Agustus diperingati sebagai hari...", options: ["Pahlawan", "Kemerdekaan", "Pendidikan", "Kartini"], correct: 1 }
                ]
            },
            'SMA': {
                'Matematika': [
                    { q: "Turunan dari 2x^2 adalah...", options: ["2x", "4x", "x", "4"], correct: 1 },
                    { q: "Nilai sin 30 derajat adalah...", options: ["1/2", "1/3", "0", "1"], correct: 0 },
                    { q: "Log 100 dengan basis 10 adalah...", options: ["1", "2", "10", "100"], correct: 1 }
                ],
                'IPA': [
                    { q: "Hukum Newton I dikenal juga sebagai hukum...", options: ["Aksi-Reaksi", "Kelembaman", "Percepatan", "Gravitasi"], correct: 1 },
                    { q: "Senyawa kimia air adalah...", options: ["CO2", "H2O", "O2", "NaCl"], correct: 1 },
                    { q: "Organel sel yang berfungsi menghasilkan energi adalah...", options: ["Ribosom", "Lisosom", "Mitokondria", "Nukleus"], correct: 2 }
                ],
                'Umum': [
                    { q: "Organisasi PBB didirikan pada tahun...", options: ["1944", "1945", "1946", "1950"], correct: 1 },
                    { q: "Mata uang negara Inggris adalah...", options: ["Dollar", "Euro", "Poundsterling", "Yen"], correct: 2 },
                    { q: "Penulis novel 'Laskar Pelangi' adalah...", options: ["Andrea Hirata", "Tere Liye", "Raditya Dika", "Habiburrahman"], correct: 0 }
                ]
            }
        };

        // --- 2. STATE MANAGEMENT ---
        let currentLevel = 'SMP'; 
        let currentQuizQuestions = [];
        let currentQuestionIndex = 0;
        let userScore = 0;
        let currentSubject = '';

        // --- 3. CORE FUNCTIONS ---

        function switchLevel(level) {
            currentLevel = level;
            const data = contentData[level];
            const header = document.getElementById('level-header');

            // Update UI Button Styles
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.className = `level-btn px-6 py-2 rounded-full border-2 border-gray-100 bg-gray-50 text-gray-600 font-bold hover:bg-gray-200 transition flex items-center gap-2`;
            });

            const activeBtn = document.getElementById(`btn-${level.toLowerCase()}`);
            let colorClass = level === 'SD' ? 'bg-red-600 border-red-500 shadow-red-200' : 
                             level === 'SMP' ? 'bg-blue-600 border-blue-500 shadow-blue-200' : 
                             'bg-gray-700 border-gray-600 shadow-gray-400';
            
            activeBtn.className = `level-btn px-6 py-2 rounded-full border-2 text-white font-bold shadow-lg transition flex items-center gap-2 ${colorClass}`;

            // Update Header
            header.innerHTML = `
                <div class="bg-gradient-to-r from-${data.color}-600 to-${data.color}-500 rounded-2xl p-8 text-white relative overflow-hidden">
                    <div class="relative z-10">
                        <span class="bg-white/20 px-3 py-1 rounded-full text-xs font-bold mb-2 inline-block">Mode Siswa ${level}</span>
                        <h1 class="text-3xl font-bold font-display mb-2">${data.title}</h1>
                        <p class="opacity-90 max-w-xl">${data.desc}</p>
                    </div>
                    <i class="fas fa-book-open absolute right-4 bottom-[-20px] text-9xl opacity-10 rotate-12"></i>
                </div>
            `;
            
            // Animation reset
            header.classList.remove('fade-in');
            void header.offsetWidth;
            header.classList.add('fade-in');

            // Reset Tab Views if needed
            document.getElementById('quiz-title-display').innerText = data.quizTitle;
            resetQuiz(); // Reset quiz if level changes
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(`tab-${tabName}`).classList.remove('hidden');

            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.className = 'tab-btn border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium pb-3 px-2 whitespace-nowrap relative';
            });
            
            event.currentTarget.className = 'tab-btn active border-b-2 border-primary text-primary font-bold pb-3 px-2 whitespace-nowrap relative';
        }

        // --- 4. QUIZ LOGIC ENGINE ---

        function startQuiz(subject) {
            // Setup Data
            currentSubject = subject;
            // Get questions based on Level AND Subject. Fallback to empty array if not found.
            if(quizDatabase[currentLevel] && quizDatabase[currentLevel][subject]) {
                currentQuizQuestions = quizDatabase[currentLevel][subject];
            } else {
                alert("Maaf, soal untuk mata pelajaran ini belum tersedia.");
                return;
            }
            
            currentQuestionIndex = 0;
            userScore = 0;

            // Update UI
            document.getElementById('quiz-menu').classList.add('hidden');
            document.getElementById('quiz-interface').classList.remove('hidden');
            document.getElementById('quiz-result').classList.add('hidden');

            document.getElementById('active-subject').innerText = subject;
            document.getElementById('q-total').innerText = currentQuizQuestions.length;
            document.getElementById('current-score').innerText = '0';

            loadQuestion();
        }

        function loadQuestion() {
            const q = currentQuizQuestions[currentQuestionIndex];
            document.getElementById('q-current').innerText = currentQuestionIndex + 1;
            document.getElementById('question-text').innerText = q.q;
            document.getElementById('btn-next').classList.add('hidden');

            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = ''; // Clear previous options

            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn w-full text-left p-4 rounded-xl border-2 border-gray-200 hover:border-primary hover:bg-blue-50 transition font-medium text-gray-700 flex justify-between items-center group';
                btn.innerHTML = `<span>${opt}</span> <i class="far fa-circle text-gray-400 group-hover:text-primary"></i>`;
                btn.onclick = () => checkAnswer(index, btn);
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selectedIndex, btnElement) {
            // Prevent multiple clicks
            const allButtons = document.querySelectorAll('.option-btn');
            allButtons.forEach(btn => btn.disabled = true);

            const correctIndex = currentQuizQuestions[currentQuestionIndex].correct;

            if (selectedIndex === correctIndex) {
                // Correct Logic
                btnElement.classList.remove('border-gray-200', 'hover:border-primary', 'hover:bg-blue-50');
                btnElement.classList.add('correct');
                btnElement.querySelector('i').className = 'fas fa-check-circle text-green-600';
                userScore += 100; // Example scoring
            } else {
                // Wrong Logic
                btnElement.classList.remove('border-gray-200', 'hover:border-primary', 'hover:bg-blue-50');
                btnElement.classList.add('wrong');
                btnElement.querySelector('i').className = 'fas fa-times-circle text-red-600';
                
                // Highlight Correct One
                const correctBtn = allButtons[correctIndex];
                correctBtn.classList.remove('border-gray-200');
                correctBtn.classList.add('correct');
                correctBtn.querySelector('i').className = 'fas fa-check-circle text-green-600';
            }

            // Update Score Display
            document.getElementById('current-score').innerText = userScore;

            // Show Next Button
            document.getElementById('btn-next').classList.remove('hidden');
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentQuizQuestions.length) {
                loadQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            document.getElementById('quiz-interface').classList.add('hidden');
            document.getElementById('quiz-result').classList.remove('hidden');
            
            document.getElementById('result-subject').innerText = currentSubject;
            document.getElementById('final-score-display').innerText = userScore;
            
            // Calculate percentage for feedback
            const maxScore = currentQuizQuestions.length * 100;
            const percentage = (userScore / maxScore) * 100;
            
            let feedback = "";
            if (percentage === 100) feedback = "Sempurna! Kamu hebat sekali! ðŸŒŸ";
            else if (percentage >= 70) feedback = "Bagus sekali! Pertahankan! ðŸ‘";
            else if (percentage >= 40) feedback = "Cukup bagus, tapi perlu belajar lagi. ðŸ’ª";
            else feedback = "Jangan menyerah, ayo coba lagi! ðŸ”¥";
            
            document.getElementById('final-feedback').innerText = feedback;
        }

        function resetQuiz() {
            document.getElementById('quiz-interface').classList.add('hidden');
            document.getElementById('quiz-result').classList.add('hidden');
            document.getElementById('quiz-menu').classList.remove('hidden');
        }

        // Initialize default state
        switchLevel('SMP');
    </script>
</body>
</html>
